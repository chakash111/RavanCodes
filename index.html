<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ravan Codes</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="card">
        <div class="profile-img">
            <img src="https://i.ibb.co/HThZcKrd/file-00000000ae507208831d1518a15bc4e6.png" alt="Ravan">
        </div>

        <h2>RAVAN</h2>
        <p>Web Developer | Beat Maker</p>

        <div class="social-links">
            <a href="https://www.instagram.com/ch_akash_111?igsh=a2V2YnI1cXpkMzdu" class="btn insta">Instagram</a>
            <a href="https://youtube.com/@akash_yt517?si=Ti5bpQwMO5Klh4wx" class="btn yt">YouTube</a>
        </div>

        <div class="music-section">
            <audio id="myBeat" preload="auto">
                <source src="https://files.catbox.moe/qgnhtv.mp3" type="audio/mpeg">
            </audio>
            <button onclick="toggleMusic()" class="btn music-btn" id="pBtn">Play Beat üéµ</button>
        </div>

        <div class="about-section">
            <p>üëã Main abhi <b>Web Development</b> aur <b>Music</b> seekh raha hoon. Ye meri pehli website hai jo maine mobile par banayi hai!</p>
        </div>
    </div>
   <div class="bpm-container">
     <h2 class="neon-text">‚ö° BPM Real-Time Detector</h2>
     <p>Apna track upload karo aur magic dekho!</p>
    
    <div class="upload-area" id="drop-zone">
        <input type="file" id="audio-file" accept="audio/*" hidden>
        <label for="audio-file" class="upload-btn">üìÅ Choose Audio File</label>
    </div>

    <div id="loader" class="loader" style="display: none;">Analyzing Beats... ü•Å</div>
    
    <div class="result-box">
        <span id="bpm-value">--</span>
        <span class="label">BPM</span>
    </div>
   </div>
    <script>
    var song = document.getElementById("myBeat");
    var pBtn = document.getElementById("pBtn");
    var card = document.querySelector(".card");

    let audioCtx, source, analyser, canvas, ctx, bufferLength, dataArray;

    function toggleMusic() {
        if (song.paused) {
            song.play().then(() => {
                pBtn.innerHTML = "Pause Beat ‚è∏Ô∏è";
                card.classList.add("playing");
                // Visualizer ko start karo
                if (!audioCtx) {
                    initVisualizer();
                }
            }).catch(err => {
                alert("Bhai, pehle screen par kahin touch karo!");
            });
        } else {
            song.pause();
            pBtn.innerHTML = "Play Beat üéµ";
            card.classList.remove("playing");
        }
    }

    function initVisualizer() {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        source = audioCtx.createMediaElementSource(song);
        source.connect(analyser);
        analyser.connect(audioCtx.destination);

        analyser.fftSize = 64;
        bufferLength = analyser.frequencyBinCount;
        dataArray = new Uint8Array(bufferLength);

        canvas = document.getElementById('visualizer');
        ctx = canvas.getContext('2d');
        draw();
    }

    function draw() {
        requestAnimationFrame(draw);
        analyser.getByteFrequencyData(dataArray);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        let barWidth = (canvas.width / bufferLength) * 2;
        let x = 0;
        for (let i = 0; i < bufferLength; i++) {
            let barHeight = dataArray[i] / 4;
            ctx.fillStyle = "#00ffcc"; // Neon Green
            ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
            x += barWidth + 2;
        }
    }

    // --- BPM DETECTOR ---
    document.getElementById('audio-file').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        const bpmDisplay = document.getElementById('bpm-value');
        bpmDisplay.innerText = 'Wait...';
        const reader = new FileReader();
        reader.onload = function(event) {
            const tempCtx = new (window.AudioContext || window.webkitAudioContext)();
            tempCtx.decodeAudioData(event.target.result, function(buffer) {
                // Yahan 140 default placeholder for testing
                bpmDisplay.innerText = '140'; 
            });
        };
        reader.readAsArrayBuffer(file);
    });
</script>

        
</body>
</html>
