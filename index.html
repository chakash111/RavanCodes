<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAVAN HUB</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="card">
        <h2>RAVAN HUB</h2>
        <div class="nav">
            <button id="btn-beat" class="nav-btn active" onclick="showSection('beat')">üéπ Beat Lab</button>
            <button id="btn-code" class="nav-btn" onclick="showSection('code')">üíª Code & Create</button>
        </div>

        <div id="beat-section">
            <div class="controls">
                <button id="playBtn" onclick="togglePlay()">PLAY ‚ñ∂Ô∏è</button>
                <div class="bpm-box">
                    BPM <input type="number" id="bpm" value="140" onchange="updateBPM()">
                </div>
            </div>
            <div class="sequencer">
                <div class="track"><span class="label">KICK</span><div class="steps" data-sound="kick"></div></div>
                <div class="track"><span class="label">SNARE</span><div class="steps" data-sound="snare"></div></div>
                <div class="track"><span class="label">HIHAT</span><div class="steps" data-sound="hihat"></div></div>
            </div>
        </div>

        <div id="code-section" style="display:none;">
            <h3 style="color:#00ffcc; margin-top:0;">My Study</h3>
            <p>Main abhi <b>Web Development</b> aur <b>Music</b> seekh raha hoon. Ye meri pehli website hai jo maine mobile par banayi hai!</p>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isPlaying = false, currentStep = 0, nextStepTime = 0, tempo = 140;

        // Step buttons generate karna
        document.querySelectorAll('.steps').forEach(container => {
            for (let i = 0; i < 8; i++) {
                const step = document.createElement('div');
                step.classList.add('step');
                step.onclick = () => { 
                    if (audioCtx.state === 'suspended') audioCtx.resume(); 
                    step.classList.toggle('active'); 
                };
                container.appendChild(step);
            }
        });

        function playSound(type) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            
            if (type === 'kick') {
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                gain.gain.setValueAtTime(1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            } else if (type === 'snare') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(100, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            } else {
                osc.type = 'square';
                osc.frequency.setValueAtTime(10000, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.05);
            }
            osc.start(); osc.stop(audioCtx.currentTime + 0.2);
        }

        function scheduler() {
            while (nextStepTime < audioCtx.currentTime + 0.1) {
                playStep(); nextNote();
            }
            if (isPlaying) requestAnimationFrame(scheduler);
        }

        function playStep() {
            document.querySelectorAll('.track').forEach(track => {
                const allSteps = track.querySelectorAll('.step');
                const step = allSteps[currentStep];
                document.querySelectorAll('.step').forEach(s => s.classList.remove('playing'));
                step.classList.add('playing');
                if (step.classList.contains('active')) playSound(track.querySelector('.steps').dataset.sound);
            });
        }

        function nextNote() { 
            nextStepTime += (60.0 / tempo / 2); 
            currentStep = (currentStep + 1) % 8; 
        }

        function togglePlay() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            isPlaying = !isPlaying;
            document.getElementById('playBtn').innerText = isPlaying ? "STOP ‚èπÔ∏è" : "PLAY ‚ñ∂Ô∏è";
            if (isPlaying) { 
                currentStep = 0; 
                nextStepTime = audioCtx.currentTime; 
                scheduler(); 
            }
        }

        function updateBPM() { tempo = document.getElementById('bpm').value; }

        function showSection(section) {
            document.getElementById('beat-section').style.display = section === 'beat' ? 'block' : 'none';
            document.getElementById('code-section').style.display = section === 'code' ? 'block' : 'none';
            document.getElementById('btn-beat').classList.toggle('active', section === 'beat');
            document.getElementById('btn-code').classList.toggle('active', section === 'code');
        }
    </script>
</body>
</html>
